//
//  MoviesPageTests.swift
//  NowPlayingTMDBTests
//
//  Created by Yuichi Fujiki on 4/24/19.
//  Copyright © 2019 Yfujiki. All rights reserved.
//

import XCTest

@testable import NowPlayingTMDB

class MoviesPageTests: XCTestCase {

    let modelString = """
{"results":[{"vote_count":4069,"id":299537,"video":false,"vote_average":7.1,"title":"Captain Marvel","popularity":390.7,"poster_path":"/AtsgWhDnHTq68L0lLsUrCnM7TjG.jpg","original_language":"en","original_title":"Captain Marvel","genre_ids":[28,12,878],"backdrop_path":"/w2PMyoyLU22YvrGK3smVM9fW1jj.jpg","adult":false,"overview":"The story follows Carol Danvers as she becomes one of the universe’s most powerful heroes when Earth is caught in the middle of a galactic war between two alien races. Set in the 1990s, Captain Marvel is an all-new adventure from a previously unseen period in the history of the Marvel Cinematic Universe.","release_date":"2019-03-06"},{"vote_count":222,"id":456740,"video":false,"vote_average":5.3,"title":"Hellboy","popularity":321.833,"poster_path":"/bk8LyaMqUtaQ9hUShuvFznQYQKR.jpg","original_language":"en","original_title":"Hellboy","genre_ids":[28,12,14],"backdrop_path":"/5BkSkNtfrnTuKOtTaZhl8avn4wU.jpg","adult":false,"overview":"Hellboy comes to England, where he must defeat Nimue, Merlin's consort and the Blood Queen. But their battle will bring about the end of the world, a fate he desperately tries to turn away.","release_date":"2019-04-10"},{"vote_count":497,"id":537915,"video":false,"vote_average":6.5,"title":"After","popularity":262.288,"poster_path":"/u3B2YKUjWABcxXZ6Nm9h10hLUbh.jpg","original_language":"en","original_title":"After","genre_ids":[18,10749],"backdrop_path":"/8lESY7UGpOsbL2caib9Qe4bOebF.jpg","adult":false,"overview":"A young woman falls for a guy with a dark secret and the two embark on a rocky relationship.","release_date":"2019-04-11"},{"vote_count":1177,"id":287947,"video":false,"vote_average":7.2,"title":"Shazam!","popularity":259.802,"poster_path":"/xnopI5Xtky18MPhK40cZAGAOVeV.jpg","original_language":"en","original_title":"Shazam!","genre_ids":[35,12,14],"backdrop_path":"/bi4jh0Kt0uuZGsGJoUUfqmbrjQg.jpg","adult":false,"overview":"A boy is given the ability to become an adult superhero in times of need with a single magic word.","release_date":"2019-03-23"},{"vote_count":106,"id":480414,"video":false,"vote_average":5.7,"title":"The Curse of La Llorona","popularity":149.833,"poster_path":"/jhZlXSnFUpNiLAek9EkPrtLEWQI.jpg","original_language":"en","original_title":"The Curse of La Llorona","genre_ids":[53,27,9648],"backdrop_path":"/u2vGggeMPAkhEtD7bYGfeThsQiM.jpg","adult":false,"overview":"A social worker dealing with the disappearance of two children fears for her own family after beginning the investigation.","release_date":"2019-04-17"},{"vote_count":1563,"id":166428,"video":false,"vote_average":7.6,"title":"How to Train Your Dragon: The Hidden World","popularity":146.75,"poster_path":"/xvx4Yhf0DVH8G4LzNISpMfFBDy2.jpg","original_language":"en","original_title":"How to Train Your Dragon: The Hidden World","genre_ids":[16,10751,12],"backdrop_path":"/lFwykSz3Ykj1Q3JXJURnGUTNf1o.jpg","adult":false,"overview":"As Hiccup fulfills his dream of creating a peaceful dragon utopia, Toothless’ discovery of an untamed, elusive mate draws the Night Fury away. When danger mounts at home and Hiccup’s reign as village chief is tested, both dragon and rider must make impossible decisions to save their kind.","release_date":"2019-01-03"},{"vote_count":148,"id":487297,"video":false,"vote_average":5.6,"title":"What Men Want","popularity":128.248,"poster_path":"/30IiwvIRqPGjUV0bxJkZfnSiCL.jpg","original_language":"en","original_title":"What Men Want","genre_ids":[35,14,10749],"backdrop_path":"/umecegsPpKr2ZXA62Da9CQBVoIO.jpg","adult":false,"overview":"Magically able to hear what men are thinking, a sports agent uses her newfound ability to turn the tables on her overbearing male colleagues.","release_date":"2019-02-08"},{"vote_count":953,"id":329996,"video":false,"vote_average":6.7,"title":"Dumbo","popularity":102.26,"poster_path":"/279PwJAcelI4VuBtdzrZASqDPQr.jpg","original_language":"en","original_title":"Dumbo","genre_ids":[12,10751,14],"backdrop_path":"/5tFt6iuGnKapHl5tw0X0cKcnuVo.jpg","adult":false,"overview":"A young elephant, whose oversized ears enable him to fly, helps save a struggling circus, but when the circus plans a new venture, Dumbo and his friends discover dark secrets beneath its shiny veneer.","release_date":"2019-03-27"},{"vote_count":2036,"id":424783,"video":false,"vote_average":6.4,"title":"Bumblebee","popularity":101.533,"poster_path":"/fw02ONlDhrYjTSZV8XO6hhU3ds3.jpg","original_language":"en","original_title":"Bumblebee","genre_ids":[28,12,878],"backdrop_path":"/wtZj5nn6hVwgakPdg6y6gm3eFXU.jpg","adult":false,"overview":"On the run in the year 1987, Bumblebee finds refuge in a junkyard in a small Californian beach town. Charlie, on the cusp of turning 18 and trying to find her place in the world, discovers Bumblebee, battle-scarred and broken.  When Charlie revives him, she quickly learns this is no ordinary yellow VW bug.","release_date":"2018-12-15"},{"vote_count":1131,"id":458723,"video":false,"vote_average":7.2,"title":"Us","popularity":97.959,"poster_path":"/ux2dU1jQ2ACIMShzB3yP93Udpzc.jpg","original_language":"en","original_title":"Us","genre_ids":[53,27],"backdrop_path":"/jNUCddkM1fjYcFIcEwFjc7s2H4V.jpg","adult":false,"overview":"Husband and wife Gabe and Adelaide Wilson take their kids to their beach house expecting to unplug and unwind with friends. But as night descends, their serenity turns to tension and chaos when some shocking visitors arrive uninvited.","release_date":"2019-03-14"},{"vote_count":925,"id":522681,"video":false,"vote_average":6.3,"title":"Escape Room","popularity":92.621,"poster_path":"/8Ls1tZ6qjGzfGHjBB7ihOnf7f0b.jpg","original_language":"en","original_title":"Escape Room","genre_ids":[53],"backdrop_path":"/mWLljCmpqlcYQh7uh51BBMwCZwN.jpg","adult":false,"overview":"Six strangers find themselves in circumstances beyond their control, and must use their wits to survive.","release_date":"2019-01-03"},{"vote_count":53,"id":376865,"video":false,"vote_average":6.2,"title":"High Life","popularity":78.17,"poster_path":"/wElOvH7H6sLElsTOLu1MY6oWRUx.jpg","original_language":"en","original_title":"High Life","genre_ids":[18,9648,878],"backdrop_path":"/6gHdAO1Lvk9bjzhY4hX3wVRkAhF.jpg","adult":false,"overview":"Monte and his baby daughter are the last survivors of a damned and dangerous mission to the outer reaches of the solar system. They must now rely on each other to survive as they hurtle toward the oblivion of a black hole.","release_date":"2018-11-07"},{"vote_count":1,"id":498580,"video":false,"vote_average":0,"title":"Kanchana 3","popularity":66.763,"poster_path":"/eV5uk58nNkTIDyn0HF9Hio1YBLX.jpg","original_language":"ta","original_title":"Kanchana 3","genre_ids":[35,27],"backdrop_path":"/6IftJA2bm4IBEGJV1nG7oJzK5TB.jpg","adult":false,"overview":"Kanchana 3 is an UpcomingTamil horror Revenge film directed by Raghava Lawrence, starring himself, Oviya and Vedhika in the leading roles.","release_date":"2019-04-19"},{"vote_count":1303,"id":504172,"video":false,"vote_average":6.4,"title":"The Mule","popularity":64.779,"poster_path":"/oeZh7yEz3PMnZLgBPhrafFHRbVz.jpg","original_language":"en","original_title":"The Mule","genre_ids":[80,18,53],"backdrop_path":"/bTeRgkAavyw1eCtSkaww18wLYNP.jpg","adult":false,"overview":"Earl Stone, a man in his 80s, is broke, alone, and facing foreclosure of his business when he is offered a job that simply requires him to drive. Easy enough, but, unbeknownst to Earl, he’s just signed on as a drug courier for a Mexican cartel. He does so well that his cargo increases exponentially, and Earl hit the radar of hard-charging DEA agent Colin Bates.","release_date":"2018-12-14"},{"vote_count":64,"id":411728,"video":false,"vote_average":7.2,"title":"The Professor and the Madman","popularity":63.248,"poster_path":"/gtGCDLhfjW96qVarwctnuTpGOtD.jpg","original_language":"en","original_title":"The Professor and the Madman","genre_ids":[18,36,9648],"backdrop_path":"/zhNfM1CSQqJtIqelwlK9iKtSd9P.jpg","adult":false,"overview":"Professor James Murray begins work compiling words for the first edition of the Oxford English Dictionary in the mid 19th century and receives over 10,000 entries from a patient at Broadmoor Criminal Lunatic Asylum , Dr William Minor.","release_date":"2019-03-07"},{"vote_count":109,"id":471507,"video":false,"vote_average":5.7,"title":"Destroyer","popularity":59.258,"poster_path":"/sHw9gTdo43nJL82py0oaROkXXNr.jpg","original_language":"en","original_title":"Destroyer","genre_ids":[53,80,18,28],"backdrop_path":"/rURV5xPzt9ZxEXAc4OQmxchGyZ8.jpg","adult":false,"overview":"Erin Bell is an LAPD detective who, as a young cop, was placed undercover with a gang in the California desert with tragic results. When the leader of that gang re-emerges many years later, she must work her way back through the remaining members and into her own history with them to finally reckon with the demons that destroyed her past.","release_date":"2018-12-25"},{"vote_count":300,"id":157433,"video":false,"vote_average":5.9,"title":"Pet Sematary","popularity":55.133,"poster_path":"/7SPhr7Qj39vbnfF9O2qHRYaKHAL.jpg","original_language":"en","original_title":"Pet Sematary","genre_ids":[27,53],"backdrop_path":"/n2aX63BmW7zIKgKJ58e6rKlSsdi.jpg","adult":false,"overview":"Louis Creed, his wife Rachel and their two children Gage and Ellie move to a rural home where they are welcomed and enlightened about the eerie 'Pet Sematary' located nearby. After the tragedy of their cat being killed by a truck, Louis resorts to burying it in the mysterious pet cemetery, which is definitely not as it seems, as it proves to the Creeds that sometimes dead is better.","release_date":"2019-04-04"},{"vote_count":139,"id":454294,"video":false,"vote_average":6.1,"title":"The Kid Who Would Be King","popularity":54.004,"poster_path":"/kBuvLX6zynQP0sjyqbXV4jNaZ4E.jpg","original_language":"en","original_title":"The Kid Who Would Be King","genre_ids":[28,12,14,10751],"backdrop_path":"/jmbgxBd86MshzQQvv5laKvOKoMm.jpg","adult":false,"overview":"Old-school magic meets the modern world when young Alex stumbles upon the mythical sword Excalibur. He soon unites his friends and enemies, and they become knights who join forces with the legendary wizard Merlin. Together, they must save mankind from the wicked enchantress Morgana and her army of supernatural warriors.","release_date":"2019-01-16"},{"vote_count":28,"id":458253,"video":false,"vote_average":7.3,"title":"Missing Link","popularity":52.17,"poster_path":"/gEkKHiiQRVUSX15Iwo8VFydXrtu.jpg","original_language":"en","original_title":"Missing Link","genre_ids":[16,35,12,14,10751],"backdrop_path":"/ob4XnKBqAh1rg381hayebJx6EkE.jpg","adult":false,"overview":"The charismatic Sir Lionel Frost considers himself to be the world's foremost investigator of myths and monsters. Trouble is, none of his small-minded, high-society peers seems to recognize this. Hoping to finally gain acceptance from these fellow adventurers, Sir Lionel travels to the Pacific Northwest to prove the existence of a legendary creature known as the missing link.","release_date":"2019-04-04"},{"vote_count":6977,"id":424694,"video":false,"vote_average":8.1,"title":"Bohemian Rhapsody","popularity":51.623,"poster_path":"/lHu1wtNaczFPGFDTrjCSzeLPTKN.jpg","original_language":"en","original_title":"Bohemian Rhapsody","genre_ids":[18,10402],"backdrop_path":"/xcaSYLBhmDzJ6P14bcKe0KTh3QV.jpg","adult":false,"overview":"Singer Freddie Mercury, guitarist Brian May, drummer Roger Taylor and bass guitarist John Deacon take the music world by storm when they form the rock 'n' roll band Queen in 1970. Hit songs become instant classics. When Mercury's increasingly wild lifestyle starts to spiral out of control, Queen soon faces its greatest challenge yet – finding a way to keep the band together amid the success and excess.","release_date":"2018-10-24"}],"page":1,"total_results":1158,"dates":{"maximum":"2019-04-22","minimum":"2019-03-05"},"total_pages":58}
"""

    lazy var modelData: Data = {
        Data(modelString.utf8)
    }()

    override func setUp() {
        // Put setup code here. This method is called before the invocation of each test method in the class.
    }

    override func tearDown() {
        // Put teardown code here. This method is called after the invocation of each test method in the class.
    }

    func testDecode() {
        do {
            let moviesPage = try MoviesPage(from: modelData)
            XCTAssertEqual(1, moviesPage.page)
            XCTAssertEqual(58, moviesPage.totalPages)
            XCTAssertEqual(1158, moviesPage.totalResults)
            XCTAssertEqual(20, moviesPage.results.count)
        } catch let error {
            XCTAssert(false, "Failed with error : \(error) to encode and decode movie data.")
        }
    }

}
